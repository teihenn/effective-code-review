- [コードレビューのtips, レビュイー編](#コードレビューのtips-レビュイー編)
  - [コメントを受けて修正を行ったら、その旨の返信を行い、コミットのリンクも記載しておく](#コメントを受けて修正を行ったらその旨の返信を行いコミットのリンクも記載しておく)
  - [レビュアーからのコメントは重要だが、必ずしも全てを受け入れる必要は無い](#レビュアーからのコメントは重要だが必ずしも全てを受け入れる必要は無い)
  - [レビューが済んだがマージを保留しているものがある場合は、タイトルでわかるようにしておく](#レビューが済んだがマージを保留しているものがある場合はタイトルでわかるようにしておく)
- [コードレビューのtips, レビュアー編](#コードレビューのtips-レビュアー編)
  - [迅速にフィードバックを行う\[1\]](#迅速にフィードバックを行う1)
  - [断片的なコメントを避ける\[1\]](#断片的なコメントを避ける1)
  - [コードレビューが答えるべき最も根本的な質問：自分はこれをメンテナンス出来るか？\[2\]](#コードレビューが答えるべき最も根本的な質問自分はこれをメンテナンス出来るか2)
  - [コード作者を尊重し、質問する](#コード作者を尊重し質問する)
  - [代案無しの指摘はしない。また、代案はなるべく具体的に提示する](#代案無しの指摘はしないまた代案はなるべく具体的に提示する)
  - [礼儀正しくする\[2\]](#礼儀正しくする2)
  - [コメントにラベルを付ける\[8\]](#コメントにラベルを付ける8)
    - [ラベル例](#ラベル例)
    - [ラベルを付ける利点](#ラベルを付ける利点)
  - [PR確認をルーティンに取り入れる\[2\]](#pr確認をルーティンに取り入れる2)
  - [良い部分は称賛し感謝を伝える](#良い部分は称賛し感謝を伝える)
  - [自分のマシンにコードをチェックアウトして自分のエディタ上で見てレビューする\[2\]\[5\]](#自分のマシンにコードをチェックアウトして自分のエディタ上で見てレビューする25)
- [コードレビューのtips, レビュイー \& レビュアー編](#コードレビューのtips-レビュイー--レビュアー編)

# コードレビューのtips, レビュイー編

## コメントを受けて修正を行ったら、その旨の返信を行い、コミットのリンクも記載しておく

- コメントに対する対応を行ったら、レビュアーが自発的にPRを見にいかなくてもそれを知ることが出来るように、その旨を必ず返信する
- 修正をしたコミットのリンクやハッシュをコメントの返信時に一緒に記載し、どのコミットがコメントに対する修正なのかすぐわかるようにしてあげるとレビュワーはとても助かる
- これが無くてコミットメッセージで「レビュー指摘対応」みたいなのがたくさんあったりするとつらい

## レビュアーからのコメントは重要だが、必ずしも全てを受け入れる必要は無い

- 自分がコメントの内容に合意できない場合は、自分がなぜそのような形で変更したかなどをコメントに返信する形で説明し、健全な議論に発展させる
- ただし、コード作者はコードを自分で完成させたばかりでコンテキストを最も持っている状態のため、特にコードの読みやすさなどは評価できる立場にない。レビュワーはコード作者よりコンテキストが無い状態で読んでいるので、レビュワーの意見は軽んじられるべきではない

## レビューが済んだがマージを保留しているものがある場合は、タイトルでわかるようにしておく

- PRがApproveされておりレビューが済んでいそうなのにマージされずに残り続けているPRがある場合に、それが意図的であるならば分かるようにしておいたほうが良い
- タイトルに[マージ保留]など入れておき、PRの説明欄に具体的な理由を書いておくと良い

# コードレビューのtips, レビュアー編

## 迅速にフィードバックを行う[1]

- *レビュアーは、迅速にフィードバックを行うべきである。Googleでは、24時間以内にコードレビューからのフィードバックが行われることが期待される。レビュアーがその時間内にレビューを完了できないなら、変更を少なくとも目にしてはいてできるだけ早くレビューに着手予定であると返信するのが、良い（そして期待される）プラクティスである。*
- *Googleでの変更の大半は、約1日以内にレビューされることが期待されている（これはレビューが1日以内に終わることを必ずしも意味せず、最初のフィードバックが1日以内に提供されることを意味している）。Googleでのコード変更の約35%は、たった1つのファイルに対するものだ。レビュアーの負担が少ないことで、コードベースをより素早く変更できるようになり、作者もまた恩恵を受ける。作者は素早いレビューを求めている。1週間かそこらの間、相当な量のレビューを待つようだと、おそらく後続の変更に影響するだろう。また最初のレビューが小規模だと、後の段階で、コストが上がる労力を誤ったアプローチに無駄に費やしてしまうことも防げる。*

## 断片的なコメントを避ける[1]

- *レビュワーは、これはコードレビューに限らず、アプリやデザインレビューにおいても、思いついたフィードバックを五月雨に返す方は楽ですが、フィードバックを受け取る方は苛立つだけならまだ良い方で、精神的に疲弊するケースもあり、特に注意したいです。もし断片的な返信になってしまいそうなコードの状態である場合、そうなってしまいそうな予告と共に根本的な対応が必要な状況であることが想定されるため、非同期のレビューよりも同期的なレビューの実施が有効です。*
- Start review機能を活用する
    - 複数のコメントをまとめて一度に送信することが出来る

## コードレビューが答えるべき最も根本的な質問：自分はこれをメンテナンス出来るか？[2]

- いちばん重要な基準は、コードが読みやすいかどうか。コードは脳に収まるか？
- メソッドが長すぎたり複雑すぎたりしないのか？

## コード作者を尊重し、質問する

- *一般に、レビュアーはコード作者の特定アプローチについて作者を尊重すべきであり、作者のアプローチが不十分な場合にのみ代案の指摘を行うべきだ。作者が同等の妥当なアプローチをいくつか示せるなら、レビュアーはその作者の選好を受け入れるべきである。(〜中略〜)そのアプローチが間違っていると決めてかかる前に、何故そのようなアプローチが採られたかについて質問した方がよい。*[1]
- 好みの話くらいのものは押し付けないよう気を付ける

## 代案無しの指摘はしない。また、代案はなるべく具体的に提示する

- 指摘だけだとレビュイーも困るかもしれないので、せめてこちらの修正イメージ伝えるとかは最低でもしたほうが良い
- 代案が曖昧だとまたそこでレビュイーが悩んでしまったりするので具体的に提示できるならそうしたほうが良い
- また、なるべく具体的に提示することで、こちらのコメントを受けてレビュイーの行ってくれた修正と自分の修正イメージが微妙に違うが再度指摘するのも憚られる、みたいな状況になるのも防ぎやすい

## 礼儀正しくする[2]

- コードレビューは非同期なワークフローであり、通常は文字でレビューすることになる。文字だとトーンや意図は簡単に失われる。悪意を与えるつもりのない言い回しでも、受け手はそれを読んで傷つくこともある。必要以上に礼儀正しくする。

## コメントにラベルを付ける[8]

### ラベル例

| ラベル | 意味 | 意図 |
|--------|------|------|
| ASK | 質問 (Question) | 質問。相手は回答が必要 |
| FYI | 参考まで (For your information) | 参考までに共有。アクションは不要 (確認事項を残す場合などに使用) |
| NITS | あら捜し (Nitpick) | 重箱の隅をつつく提案。無視しても良い |
| NR | お手すきで (No rush) | 今やらなくて良いが、将来的には解決したい提案。タスク化や修正を検討 |
| IMHO | 提案 (In my humble opinion) | 個人的な見解や、軽微な提案。タスク化や修正を検討 |
| MUST | 必須 (Must) | これを直さないと承認できない。修正を検討 |

### ラベルを付ける利点

- すべてのコメントに対して修正が必須でないので、対等な関係性となる
- するべきアクションが明確に伝わるため、認識の齟齬が起こらない
- コメントに重み付けがされるので、優先順位が明確になる
- 後でやるべきタスクを、タスク化し忘れない
- コメントの敷居が下がることより、議論の活性化

## PR確認をルーティンに取り入れる[2]

- 仕事のルーティンに組み込む
- たとえば、毎朝30分と昼食後の30分をレビューのために確保する
- 昼食前に1時間とっても良いし、帰宅前に時間を取っても良い。ただし、なにか他のことをしている途中なのでスキップする可能性が高くなる

## 良い部分は称賛し感謝を伝える

- *CL の中に素晴らしいものを見つけたら、開発者に教えてあげてください。特に、あなたのレビューコメントの一つに取り組んで素晴らしくやり遂げたらそうしてください。 コードレビューは間違いにばかり目が行きがちですが、良い実践に対しての励ましや感謝の言葉も伝えるべきです。 メンタリングの観点では、開発者が正しいこと行ったときにそれを伝えるほうが、間違いを指摘するよりもずっと価値がある場合があります。*[6]

## 自分のマシンにコードをチェックアウトして自分のエディタ上で見てレビューする[2][5]

- 実はフォーマッタがかかっていないとか、アナライザが警告を出しているとか、ブラウザ上のGitHubやBitbucketで見るだけでは気づかないものに気づくことがある
- 全部のPRに対しやる必要はないかもしれないが、やると良い
- Bitbucketなどブラウザ上で関数ジャンプが出来ないサービスでは、ブラウザ上だけで見るのがわりとつらかったりするのもある
- 自分のマシンにコードをチェックアウトしレビューすることで、プロジェクト全体のコンテキストで修正を理解しやすくなったり、自分の修正提案の動作確認を出来たり、作者にコメントしっぱなしではないより責任持ったレビューが出来る

# コードレビューのtips, レビュイー & レビュアー編

